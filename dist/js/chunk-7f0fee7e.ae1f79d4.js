(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7f0fee7e"],{"0214":function(t,e,r){"use strict";r.r(e);var a=r("9139"),s=(r("6c00"),r("979b"),r("99dd")),i=r("5ae0"),n={name:"TeamBar",data:function(){return{filters:[{id:"1",label:"所有成员",icon:"users"},{id:"2",label:"已停用成员",icon:"user-x"}],tags:[{id:"3",label:"管理员",color:"warning"},{id:"4",label:"普通成员",color:"primary"}],isAddMemberVisible:!1,addMemnberId:""}},computed:{selectedKeys:function(){return this.$store.state.team.barKey},isSideMenuOpened:function(){return this.$store.state.isSideMenuOpened},memberList:function(){return this.$store.state.team.currProjectMemberList},otherMemberList:function(){return this.$store.state.team.otherMemberList},currProjectID:function(){return this.$store.state.project.currProjectId}},created:function(){this.getAllUser()},methods:{onOpenDrawer:function(){this.$store.commit("team/SET_TEAM_DRAWER_STATUS",!0)},onClickMenuItem:function(t){var e=t.key;this.$store.commit("team/SET_TEAM_BAR_KEY",e)},closeAddModal:function(){this.isAddMemberVisible=!1},filterOption:function(t,e){return e.componentOptions.children[1].text.toLowerCase().indexOf(t.toLowerCase())>=0},getAllUser:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.currProjectID,e.next=3,Object(s.b)(r);case 3:a=e.sent,i=a.data,t.$store.commit("team/SET_OTHER_MEMBER_LIST",i);case 6:case"end":return e.stop()}}),e)})))()},addMember:function(t){this.addMemnberId=t},confirmAddMember:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={uid:t.addMemnberId,pid:t.currProjectID,option:"add"},e.next=3,Object(i.e)(r);case 3:if(a=e.sent,t.isAddMemberVisible=!1,200===a.meta.status){e.next=7;break}return e.abrupt("return",t.$message.error("添加成员失败"));case 7:return t.$message.success("添加成员成功！"),t.getMemberList(),t.getAllUser(r.pid),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})))()},getMemberList:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.currProjectID,e.next=3,Object(s.a)(r);case 3:a=e.sent,i=a.data,t.$store.commit("team/SET_CURR_PROJECT_MEMBER_LIST",i);case 6:case"end":return e.stop()}}),e)})))()}}},o=(r("7497"),r("2ca5")),c=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"px-6 py-6"},[r("a-button",{staticClass:"w-full flex justify-center items-center",attrs:{size:"large",type:"primary"},on:{click:function(e){t.isAddMemberVisible=!0}}},[r("feather",{staticClass:"mr-1",attrs:{size:"20",type:"plus"}}),t._v(" 添加成员 ")],1)],1),r("perfect-scrollbar",{staticClass:"select-none overflow-hidden",staticStyle:{height:"calc(100% - 88px)"},attrs:{options:{suppressScrollX:!0,maxScrollbarLength:160,wheelSpeed:.6}}},[r("a-menu",{staticClass:"team-bar-menu",attrs:{mode:"inline","selected-keys":t.selectedKeys},on:{click:t.onClickMenuItem}},[r("a-menu-item",{staticClass:"m-0 bg-white cursor-default",attrs:{disabled:""}},[t._v(" 查看成员 ")]),t._l(t.filters,(function(e){var a=e.id,s=e.label,i=e.icon;return r("a-menu-item",{key:a},[r("div",{staticClass:"flex items-center"},[r("feather",{staticClass:"side-menu-icon anticon",attrs:{size:"20",type:i}}),r("span",{staticStyle:{"margin-top":"1px"}},[t._v(t._s(s))])],1)])})),r("a-menu-item",{staticClass:"mt-6 mb-0 bg-white cursor-default",attrs:{disabled:""}},[t._v(" 成员角色 ")]),t._l(t.tags,(function(e){var a=e.id,s=e.label,i=e.color;return r("a-menu-item",{key:a},[r("div",{staticClass:"flex justify-between items-center"},[r("span",{staticStyle:{"margin-top":"1px"}},[t._v(t._s(s))]),r("div",{staticClass:"w-2 h-2 mr-2 rounded-full",class:"bg-"+i})])])}))],2)],1),r("a-modal",{attrs:{width:360,visible:t.isAddMemberVisible,title:"添加成员"},on:{cancel:t.closeAddModal,ok:t.confirmAddMember}},[r("div",{staticClass:"ml-4"},[r("a-tabs",{attrs:{"default-active-key":"1"}},[r("a-tab-pane",{key:"1",attrs:{tab:"通过账号邀请"}},[r("div",[r("a-select",{staticStyle:{width:"95%"},attrs:{"show-search":"",placeholder:"输入成员姓名关键字","option-filter-prop":"value","filter-option":t.filterOption},on:{change:t.addMember}},t._l(t.otherMemberList,(function(e,a){return r("a-select-option",{key:a,attrs:{value:e.uid}},[r("a-avatar",{staticClass:"ml-1 mb-2 ",attrs:{slot:"avatar",size:20,src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"},slot:"avatar"}),t._v(" "+t._s(e.name)+" ")],1)})),1)],1)]),r("a-tab-pane",{key:"2",attrs:{tab:"通过邮箱邀请","force-render":""}},[t._v(" 通过邮箱邀请 ")])],1)],1)])],1)}),[],!1,null,"54919c28",null).exports,l=r("2eb8"),u=r("bd40"),m={name:"TeamList",data:function(){return{searchInputText:"搜索成员...",memberInfo:{role:"",is_active:1,uid:"",pid:"",option:""}}},computed:{currProjectID:function(){return this.$store.state.project.currProjectId},filterItems:function(){return this.$store.getters["team/filterItems"]},currEditMember:function(){return this.$store.state.team.currEditMember},isDrawerOpened:function(){return this.$store.state.team.isTeamDrawerOpened},memberList:function(){return this.$store.state.team.currProjectMemberList}},created:function(){this.init()},methods:{init:function(){this.getMemberList()},initMember:function(t){this.getMemberInfo(t),this.getProject(t),this.getTask(t)},onOpenDrawer:function(t){this.currEditMember.id?t.uid!==this.currEditMember.id?(this.initMember(t.uid),this.$store.commit("team/SET_TEAM_DRAWER_STATUS",!0)):(this.initMember(t.uid),this.$store.commit("team/SET_TEAM_DRAWER_STATUS",!this.isDrawerOpened)):(this.initMember(t.uid),this.$store.commit("team/SET_TEAM_DRAWER_STATUS",!0))},getMemberList:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.currProjectID,e.next=3,Object(s.a)(r);case 3:a=e.sent,i=a.data,t.$store.commit("team/SET_CURR_PROJECT_MEMBER_LIST",i);case 6:case"end":return e.stop()}}),e)})))()},getMemberInfo:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(i.a)(t);case 2:a=r.sent,s=a.data,e.$store.commit("team/SET_CURR_EDIT_MEMBER",s.info);case 5:case"end":return r.stop()}}),r)})))()},getProject:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(l.b)(t);case 2:return a=r.sent,s=a.data,e.$store.commit("team/SET_MEMBER_PROJECT",s),r.abrupt("return",!0);case 6:case"end":return r.stop()}}),r)})))()},getTask:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(u.k)(t);case 2:return a=r.sent,s=a.data,e.$store.commit("team/SET_MEMBER_TASK",s),r.abrupt("return",!0);case 6:case"end":return r.stop()}}),r)})))()},updateUser:function(t,e,r){var s=this;return Object(a.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s.memberInfo.uid=r,"role"===t?s.memberInfo.role=e:"active"===t?s.memberInfo.is_active=!0===e?1:0:"project"===t&&(s.memberInfo.pid=s.currProjectID,s.memberInfo.option="del"),a.next=4,Object(i.e)(s.memberInfo);case 4:if(200===a.sent.meta.status){a.next=7;break}return a.abrupt("return",s.$message.error("更新失败"));case 7:return s.$message.success("更新成功！"),s.memberInfo={role:"",is_active:!0,uid:"",pid:"",options:""},s.init(),a.abrupt("return",!0);case 11:case"end":return a.stop()}}),a)})))()}}},d=(r("4f4e"),Object(o.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"relative"},[r("div",[r("a-input",{staticClass:"search-input",attrs:{size:"large",placeholder:t.searchInputText},on:{focus:function(e){t.searchInputText="请输入成员关键字..."},blur:function(e){t.searchInputText="搜索成员..."}},scopedSlots:t._u([{key:"prefix",fn:function(){return[r("feather",{attrs:{size:"20",type:"search"}})]},proxy:!0}])})],1),r("perfect-scrollbar",{staticClass:"team-list",attrs:{options:{maxScrollbarLength:160,wheelSpeed:.6}}},[r("a-list",{staticClass:"demo-loadmore-list",attrs:{"item-layout":"horizontal","data-source":t.filterItems},scopedSlots:t._u([{key:"renderItem",fn:function(e){return r("a-list-item",{staticClass:"member-item"},[r("a",{staticClass:"ml-1 mr-2 cursor-pointer",attrs:{slot:"actions"},slot:"actions"},[r("a-tooltip",{attrs:{placement:"bottom"}},[r("template",{slot:"title"},[t._v(" 移出项目 ")]),r("a-popconfirm",{attrs:{placement:"topRight",title:"确定将该成员移出项目？"},on:{confirm:function(r){return t.updateUser("project",null,e.uid)}}},[r("feather",{attrs:{size:"20",type:"user-minus"}})],1)],2)],1),r("a",{staticClass:"ml-1 mr-2",attrs:{slot:"actions"},slot:"actions"},[r("a-tooltip",{attrs:{placement:"bottom"}},[r("template",{slot:"title"},[t._v(" "+t._s(1===e.is_active?"停用账号":"重新启用")+" ")]),r("a-popconfirm",{attrs:{placement:"topRight",title:1===e.is_active?"确定停用该成员帐号？":"确定重新启用该成员帐号？"},on:{confirm:function(r){return t.updateUser("active",!e.is_active,e.uid)}}},[r("feather",{attrs:{size:"20",type:"slash"}})],1)],2)],1),r("a-list-item-meta",{attrs:{description:e.email}},[r("a",{attrs:{slot:"title"},on:{click:function(r){return t.onOpenDrawer(e)}},slot:"title"},[t._v(t._s(e.name))]),r("a-avatar",{staticClass:"ml-6",attrs:{slot:"avatar",size:42,src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"},slot:"avatar"})],1),r("div",[r("a-dropdown",[r("div",{staticClass:"pr-2 px-2 py-1 rounded-lg text-sm cursor-pointer",class:["admin"===e.role?"warning":"primary","bg-"+("admin"===e.role?"warning":"primary")+"-light"]},[t._v(" "+t._s("admin"===e.role?"管理员":"普通成员")+" ")]),r("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[r("a-menu-item",{key:"1",on:{click:function(r){return t.updateUser("role","admin",e.uid)}}},[r("span",[t._v("管理员")])]),r("a-menu-item",{key:"2",on:{click:function(r){return t.updateUser("role","normal",e.uid)}}},[r("span",[t._v("普通成员")])])],1)],1)],1)],1)}}])})],1)],1)}),[],!1,null,"3badfc2a",null).exports),p=(r("b8fb"),{name:"TeamDrawer",computed:{isTeamDrawerOpened:function(){return this.$store.state.team.isTeamDrawerOpened},currEditMember:function(){return this.$store.state.team.currEditMember},currMemberTask:function(){return this.$store.state.team.currMemberTask},currMemberProject:function(){return this.$store.state.team.currMemberProject}},data:function(){return{currUser:{}}},created:function(){},methods:{onCloseDrawer:function(){this.$store.commit("team/SET_TEAM_DRAWER_STATUS",!1)},changeRole:function(t){}}}),f=(r("939b"),{name:"Team",components:{TeamBar:c,TeamList:d,TeamDrawer:Object(o.a)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-drawer",{staticClass:"relative",attrs:{width:"500",closable:!1,mask:!1,"get-container":!1,"wrap-style":{position:"absolute"},visible:t.isTeamDrawerOpened},scopedSlots:t._u([{key:"title",fn:function(){return[r("div",{staticClass:"flex items-center"},[r("div",{staticClass:"flex "},[t._v("成员信息")]),r("div",{staticClass:"ml-auto flex items-center text-gray-600"},[r("feather",{staticClass:"ml-2 cursor-pointer",attrs:{size:"21",type:"x"},on:{click:t.onCloseDrawer}})],1)])]},proxy:!0}])},[r("div",{staticStyle:{display:"flex",flex:"1","align-items":"flex-start"}},[r("a-avatar",{staticClass:"ml-1 mb-2 ",attrs:{slot:"avatar",size:64,src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"},slot:"avatar"}),r("div",{staticClass:"ml-4 mt-1 "},[r("div",{staticClass:"text-2xl"},[t._v(t._s(t.currEditMember.name)+" "),r("a-tag",[t._v(t._s(t.currEditMember.role))])],1),r("div",{staticStyle:{color:"rgb(181, 186, 192)"}},[t._v(t._s(t.currEditMember.email))])])],1),r("div",[r("a-tabs",{attrs:{"default-active-key":"1"}},[r("a-tab-pane",{key:"1",attrs:{tab:"详细资料"}},[r("div",{staticClass:"ml-3"},[r("a-descriptions",{attrs:{column:4,title:"详细信息"}},[r("a-descriptions-item",{attrs:{span:"2",label:"姓名"}},[t._v(" "+t._s(t.currEditMember.name)+" ")]),r("a-descriptions-item",{attrs:{span:"2",label:"邮箱"}},[t._v(" "+t._s(t.currEditMember.email)+" ")]),r("a-descriptions-item",{attrs:{span:"2",label:"职位"}},[t._v(" "+t._s(t.currEditMember.job)+" ")]),r("a-descriptions-item",{attrs:{span:"2",label:"电话"}},[t._v(" "+t._s(t.currEditMember.mobile)+" ")]),r("a-descriptions-item",{attrs:{span:"2",label:"所属部门"}},[t._v(" "+t._s(t.currEditMember.department)+" ")])],1)],1)]),r("a-tab-pane",{key:"2",attrs:{tab:"Ta的任务","force-render":""}},[r("div",[r("perfect-scrollbar",{staticClass:"overflow-hidden",staticStyle:{height:"360px"},attrs:{tag:"ul",options:{suppressScrollX:!0,maxScrollbarLength:160,wheelSpeed:.6}}},t._l(t.currMemberTask,(function(e){var a=e.t_title,s=e.t_content,i=e.pro_title,n=e.index;return r("li",{key:n,staticClass:"hover-style py-3 flex items-center"},[r("div",{staticClass:"w-8 h-10 mr-2 flex justify-center items-center rounded-full"},[r("a-checkbox",{attrs:{disabled:""}})],1),r("div",{staticClass:"flex-1 overflow-hidden"},[r("div",[t._v(t._s(a)),r("a-tag",{staticClass:"ml-3 text-sm",attrs:{color:"blue"}},[t._v(" "+t._s(i)+" ")])],1),r("div",{staticClass:"truncate"},[t._v(t._s(s))])]),r("div",{staticClass:"ml-auto text-lg text-gray-600 font-bold"})])})),0)],1)]),r("a-tab-pane",{key:"3",attrs:{tab:"Ta的项目"}},[r("div",[r("a-list",{attrs:{"item-layout":"horizontal","data-source":t.currMemberProject},scopedSlots:t._u([{key:"renderItem",fn:function(e){return r("a-list-item",{staticClass:"hover-style"},[r("a-list-item-meta",{attrs:{description:e.pro_content}},[r("a",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.pro_title))]),r("a-avatar",{attrs:{slot:"avatar",size:64,src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"},slot:"avatar"})],1)],1)}}])})],1)])],1)],1),r("div",{staticClass:"absolute right-0 bottom-0 mr-3 mb-3"},[r("a-button",{attrs:{type:"primary"},on:{click:t.onCloseDrawer}},[t._v(" 关闭 ")])],1)])}),[],!1,null,"3e057446",null).exports}}),b=(r("6fc1"),Object(o.a)(f,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"team-app"},[e("div",{staticClass:"left"},[e("team-bar",{staticClass:"h-full"})],1),e("div",{staticClass:"right"},[e("team-list",{staticClass:"h-full"})],1),e("team-drawer")],1)}),[],!1,null,"72fd82c5",null));e.default=b.exports},"4f4e":function(t,e,r){"use strict";r("ccd9")},"5e7e":function(t,e,r){},"6fc1":function(t,e,r){"use strict";r("74a3")},7497:function(t,e,r){"use strict";r("5e7e")},"74a3":function(t,e,r){},"939b":function(t,e,r){"use strict";r("f4aa")},"979b":function(t,e,r){"use strict";var a=r("bfe8"),s=r("ffef").indexOf,i=r("6e4a"),n=[].indexOf,o=!!n&&1/[1].indexOf(1,-0)<0,c=i("indexOf");a({target:"Array",proto:!0,forced:o||!c},{indexOf:function(t){return o?n.apply(this,arguments)||0:s(this,t,arguments.length>1?arguments[1]:void 0)}})},ccd9:function(t,e,r){},f4aa:function(t,e,r){}}]);